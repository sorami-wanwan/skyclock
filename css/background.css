/* ========================================
   SkyClock - 背景演出CSS
   ======================================== */

.mountain-layer {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 120%; 
    height: 100%;
    transition: all 0.3s ease-in-out;
    overflow: hidden;
    margin-left: -10%; 
    mix-blend-mode: multiply; 
}

.mountain-layer.foreground {
    z-index: 10;
    height: 100%; 
}

.mountain-layer.midground {
    z-index: 7;
    height: 100%; 
    mix-blend-mode: multiply; 
}

.mountain-layer.far {
    z-index: 5;
    height: 100%; 
    mix-blend-mode: multiply; 
}

.mountain-layer.background {
    z-index: 1;
    height: 100%; 
    mix-blend-mode: multiply; 
}


.mountain-layer svg {
    width: 100%;
    height: 100%;
    filter: none; 
    
    shape-rendering: geometricPrecision;
}


.mountain-layer.foreground::before,
.mountain-layer.midground::before,
.mountain-layer.far::before,
.mountain-layer.background::before {
    display: none;
}

/* ========================================
   樹木のスタイル（リファレンス準拠版）
   ======================================== */

.tree {
    position: absolute;
    bottom: 0;
    background: var(--current-tree-color); 
    clip-path: polygon(50% 0%, 0% 100%, 100% 100%); 
    pointer-events: none;
    z-index: 2;
    filter: none; 
}

.foreground-tree {
    --current-tree-color: #2d4a2a; 
}

.midground-tree {
    --current-tree-color: #3d5a3a; 
}


.time-morning .foreground-tree {
    --current-tree-color: #2a3d28;
}

.time-morning .midground-tree {
    --current-tree-color: #3a4d38;
}

.time-day .foreground-tree {
    --current-tree-color: #2d4a2a;
}

.time-day .midground-tree {
    --current-tree-color: #3d5a3a;
}

.time-sunset .foreground-tree {
    --current-tree-color: #3d2a28;
}

.time-sunset .midground-tree {
    --current-tree-color: #4d3a38;
}

.time-night .foreground-tree {
    --current-tree-color: #1a251a;
}

.time-night .midground-tree {
    --current-tree-color: #2a352a;
}

/* ========================================
   雲の演出（単色・リファレンス準拠版・スクリーンモード）
   ======================================== */

.cloud {
    position: absolute;
    width: 100px;
    height: 60px;
    background: var(--current-cloud-color); 
    border-radius: 50px;
    animation: cloudFloat linear infinite;
    opacity: 0.2; 
    filter: none; 
    
    backface-visibility: hidden;
    transform: translateZ(0);
    will-change: transform;
    mix-blend-mode: screen; 
    
    data-depth: 0.05;
}

.cloud::before {
    content: '';
    position: absolute;
    top: -20px;
    left: 20px;
    width: 60px;
    height: 40px;
    background: var(--current-cloud-color); 
    border-radius: 30px;
    
    backface-visibility: hidden;
    transform: translateZ(0);
    mix-blend-mode: inherit; 
    opacity: 1; 
}

.cloud::after {
    content: '';
    position: absolute;
    top: -10px;
    right: 20px;
    width: 50px;
    height: 30px;
    background: var(--current-cloud-color); 
    border-radius: 25px;
    
    backface-visibility: hidden;
    transform: translateZ(0);
    mix-blend-mode: inherit; 
    opacity: 1; 
}

@keyframes cloudFloat {
    0% {
        transform: translateX(calc(100vw + 200px)) translateZ(0); 
        opacity: 0; 
    }
    5% {
        opacity: 0.2; 
    }
    90% {
        opacity: 0.2; 
    }
    100% {
        transform: translateX(-200px) translateZ(0); 
        opacity: 0; 
    }
}

/* ========================================
   統一空気感レイヤー（リファレンス準拠版・スクリーンモード）
   ======================================== */


.atmosphere-layer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, 
        transparent 0%, 
        var(--current-atmosphere-color) 70%, 
        var(--current-atmosphere-heavy) 100%);
    pointer-events: none;
    z-index: 25; 
    mix-blend-mode: overlay; 
    
    data-depth: 0.02;
}


.fog-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to bottom, 
        transparent 0%, 
        var(--current-fog-light) 50%, 
        transparent 100%);
    animation: fogMove 50s infinite linear;
    pointer-events: none;
    z-index: 15;
    mix-blend-mode: screen; 
    
    data-depth: 0.03;
}




.fog-foreground,
.fog-background,
.fog-distant {
    display: none;
}

/* ========================================
   粒子効果（リファレンス準拠版・スクリーンモード）
   ======================================== */

.particles canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 20;
    mix-blend-mode: screen; 
}

.particles {
    
    data-depth: 0.1;
}

/* ========================================
   時間帯別の背景効果（単色・リファレンス準拠版）
   ======================================== */


.time-morning .mountain-layer {
    filter: none; 
}

.time-morning .cloud {
    background: var(--morning-cloud-flat); 
}


.time-day .mountain-layer {
    filter: none;
}

.time-day .cloud {
    background: var(--day-cloud-flat); 
}


.time-sunset .mountain-layer {
    filter: none;
}

.time-sunset .cloud {
    background: var(--sunset-cloud-flat); 
}


.time-night .mountain-layer {
    filter: none;
}

.time-night .cloud {
    background: var(--night-cloud-flat); 
}

/* ========================================
   パララックス効果（リファレンス準拠版）
   ======================================== */

.parallax-container {
    position: relative;
    width: 100%;
    height: 100vh;
    overflow: hidden;
}

.parallax-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    will-change: transform;
}

/* ========================================
   レスポンシブ対応（リファレンス準拠版）
   ======================================== */

@media (max-width: 768px) {
    .cloud {
        width: 80px;
        height: 50px;
    }
    
    .cloud::before {
        width: 50px;
        height: 30px;
        top: -15px;
        left: 15px;
    }
    
    .cloud::after {
        width: 40px;
        height: 25px;
        top: -8px;
        right: 15px;
    }
    
    .mountain-layer.foreground {
        height: 80%;
    }
    
    .mountain-layer.midground {
        height: 65%;
    }
    
    .mountain-layer.far {
        height: 50%;
    }
    
    .mountain-layer.background {
        height: 40%;
    }
}

@media (max-width: 480px) {
    .mountain-layer.foreground {
        height: 70%;
    }
    
    .mountain-layer.midground {
        height: 55%;
    }
    
    .mountain-layer.far {
        height: 45%;
    }
    
    .mountain-layer.background {
        height: 35%;
    }
    
    .cloud {
        width: 60px;
        height: 40px;
    }
}

/* ========================================
   アニメーション最適化（リファレンス準拠版）
   ======================================== */

.mountain-layer,
.cloud,
.fog-layer,
.tree,
.atmosphere-layer {
    will-change: transform;
}


.mountain-layer,
.cloud,
.tree {
    transform: translateZ(0);
}

/* ========================================
   パフォーマンス設定（リファレンス準拠版）
   ======================================== */


@media (prefers-reduced-motion: reduce) {
    .cloud {
        animation: none;
    }
    
    .fog-layer {
        animation: none;
    }
    
    .parallax-layer {
        transform: none !important;
    }
}


@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    .mountain-layer svg {
        shape-rendering: geometricPrecision;
    }
}

/* ========================================
   フルページ表示対応（リファレンス準拠版）
   ======================================== */

body {
    margin: 0;
    padding: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
}


.mountains {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 10;
    pointer-events: none;
    
    overflow: hidden;
} 

/* ========================================
   縦画面対応（Portrait Orientation）
   ======================================== */

@media (orientation: portrait) {
    
    .mountain-layer {
        width: 100%; 
        margin-left: 0; 
        height: 100%; 
    }
    
    
    .mountain-layer svg {
        width: 100%;
        height: 100%;
        
        shape-rendering: geometricPrecision;
        
        preserveAspectRatio: xMidYMid meet;
    }
    
    
    .tree {
        
        transform: scale(0.8);
    }
    
    
    .cloud {
        
        width: 80px;
        height: 48px;
    }
    
    .cloud::before {
        width: 48px;
        height: 32px;
        top: -16px;
        left: 16px;
    }
    
    .cloud::after {
        width: 40px;
        height: 24px;
        top: -8px;
        right: 16px;
    }
}


@media (orientation: portrait) and (max-aspect-ratio: 9/16) {
    .mountain-layer {
        
        width: 100%;
        margin-left: 0;
    }
    
    .mountain-layer svg {
        
        preserveAspectRatio: xMidYMid slice;
    }
    
    
    .tree {
        transform: scale(0.7);
    }
    
    
    .cloud {
        width: 70px;
        height: 42px;
    }
    
    .cloud::before {
        width: 42px;
        height: 28px;
        top: -14px;
        left: 14px;
    }
    
    .cloud::after {
        width: 35px;
        height: 21px;
        top: -7px;
        right: 14px;
    }
} 